# ğŸ¦™ CF Llama Chat

```
   â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—    â–ˆâ–ˆâ•—     â–ˆâ–ˆâ•—      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ•—   â–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—
  â–ˆâ–ˆâ•”â•â•â•â•â•â–ˆâ–ˆâ•”â•â•â•â•â•    â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ•— â–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•—
  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—      â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â–ˆâ–ˆâ–ˆâ–ˆâ•”â–ˆâ–ˆâ•‘â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•‘
  â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â•      â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•‘     â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘â•šâ–ˆâ–ˆâ•”â•â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•”â•â•â–ˆâ–ˆâ•‘
  â•šâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘         â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ•—â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘ â•šâ•â• â–ˆâ–ˆâ•‘â–ˆâ–ˆâ•‘  â–ˆâ–ˆâ•‘
   â•šâ•â•â•â•â•â•â•šâ•â•         â•šâ•â•â•â•â•â•â•â•šâ•â•â•â•â•â•â•â•šâ•â•  â•šâ•â•â•šâ•â•     â•šâ•â•â•šâ•â•  â•šâ•â•
                     ğŸš€ Enterprise AI Chat for Cloud Foundry
```

> A modern, enterprise-ready chat application built with **Spring Boot** and **Spring AI**, designed for **Tanzu Platform** and **Cloud Foundry** deployments. Inspired by [open-webui](https://github.com/open-webui/open-webui).

---

## ğŸ“¸ Screenshots

<!-- Add your screenshots here -->
| Chat Interface | Admin Portal | Metrics Dashboard |
|:---:|:---:|:---:|
| ![Chat](docs/screenshots/chat.png) | ![Admin](docs/screenshots/admin.png) | ![Metrics](docs/screenshots/metrics.png) |

---

## ğŸ—ï¸ Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TANZU PLATFORM / CLOUD FOUNDRY                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚
â”‚   â”‚              â”‚     â”‚           CF LLAMA CHAT APP                  â”‚     â”‚
â”‚   â”‚    Users     â”‚â”€â”€â”€â”€â–¶â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚     â”‚
â”‚   â”‚   ğŸ§‘â€ğŸ’» ğŸ‘©â€ğŸ’» ğŸ§‘â€ğŸ’¼   â”‚     â”‚  â”‚         Spring Boot 3.4               â”‚  â”‚     â”‚
â”‚   â”‚              â”‚     â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚  â”‚     â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚  â”‚  â”‚   Chat   â”‚  â”‚  Admin   â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”‚ Service  â”‚  â”‚  Portal  â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”˜            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚       â”‚             â”‚                   â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”Œâ”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”‚      Spring AI 1.1     â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”‚  â”‚  GenAI Locator  â”‚   â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚            â”‚  â”‚     â”‚
â”‚                        â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚  â”‚     â”‚
â”‚                        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚     â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚
â”‚                                          â”‚                                   â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚                    VCAP_SERVICES BINDINGS                            â”‚   â”‚
â”‚   â”‚                                      â”‚                               â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚   â”‚
â”‚   â”‚  â”‚                    tanzu-all-models                            â”‚  â”‚   â”‚
â”‚   â”‚  â”‚              (GenAI Multi-Model Binding)                       â”‚  â”‚   â”‚
â”‚   â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ ğŸ’¬ Chat     â”‚ â”‚ ğŸ’¬ Chat     â”‚ â”‚ ğŸ”¢ Embeddingâ”‚              â”‚  â”‚   â”‚
â”‚   â”‚  â”‚  â”‚ GPT-OSS-120Bâ”‚ â”‚ Qwen3-30B   â”‚ â”‚ Nomic-Embed â”‚              â”‚  â”‚   â”‚
â”‚   â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚   â”‚
â”‚   â”‚                                                                      â”‚   â”‚
â”‚   â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”‚   â”‚
â”‚   â”‚  â”‚ ğŸ—„ï¸ PostgreSQL   â”‚  â”‚ ğŸ” SSO Service  â”‚  â”‚ ğŸ› ï¸ MCP Servers  â”‚     â”‚   â”‚
â”‚   â”‚  â”‚   + pgvector    â”‚  â”‚  (p-identity)   â”‚  â”‚   (optional)    â”‚     â”‚   â”‚
â”‚   â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸŒŸ Key Features

### ğŸ¤– Tanzu GenAI Integration

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘  ğŸ¯ AUTOMATIC MODEL DISCOVERY                                  â•‘
â•‘                                                                 â•‘
â•‘  tanzu-all-models â”€â”€â”€â”€â”€â”€â–¶ GenAI Locator                        â•‘
â•‘       â”‚                        â”‚                                â•‘
â•‘       â”‚                        â–¼                                â•‘
â•‘       â”‚              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                        â•‘
â•‘       â”‚              â”‚ getModelNames   â”‚                        â•‘
â•‘       â”‚              â”‚ ByCapability()  â”‚                        â•‘
â•‘       â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â•‘
â•‘       â”‚                       â”‚                                 â•‘
â•‘       â–¼                       â–¼                                 â•‘
â•‘  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”                         â•‘
â•‘  â”‚  CHAT   â”‚  â”‚  CHAT   â”‚  â”‚EMBEDDINGâ”‚                         â•‘
â•‘  â”‚ Model 1 â”‚  â”‚ Model 2 â”‚  â”‚  Model  â”‚                         â•‘
â•‘  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                         â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

- **ğŸ”„ Multi-Model Binding**: Single `tanzu-all-models` service discovers all available models
- **ğŸ“¡ Dynamic Discovery**: Uses `GenaiLocator.getModelNamesByCapability()` for runtime discovery
- **ğŸ”™ Backward Compatible**: Still supports individual model service bindings
- **ğŸ§  Smart Routing**: Automatically routes to correct model based on capability (CHAT vs EMBEDDING)

### ğŸ“„ Document RAG (Retrieval-Augmented Generation)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ“„ PDF  â”‚     â”‚   Chunking   â”‚     â”‚  Embedding   â”‚     â”‚   PgVector   â”‚
â”‚  ğŸ“ Word â”‚â”€â”€â”€â”€â–¶â”‚  (350 tokens)â”‚â”€â”€â”€â”€â–¶â”‚ nomic-embed  â”‚â”€â”€â”€â”€â–¶â”‚    Store     â”‚
â”‚  ğŸ“ƒ Text â”‚     â”‚              â”‚     â”‚              â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                                   â”‚
                                                                   â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚    ğŸ’¬    â”‚     â”‚   Semantic   â”‚     â”‚   Context    â”‚     â”‚   Enhanced   â”‚
â”‚  Query   â”‚â”€â”€â”€â”€â–¶â”‚    Search    â”‚â”€â”€â”€â”€â–¶â”‚  Injection   â”‚â”€â”€â”€â”€â–¶â”‚   Response   â”‚
â”‚          â”‚     â”‚   (Top-K)    â”‚     â”‚              â”‚     â”‚              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ğŸ“¤ User Document Upload**: PDF, Word, text files supported
- **âœ‚ï¸ Smart Chunking**: Automatic chunking optimized for embedding model limits
- **ğŸ” Vector Search**: Semantic search using PostgreSQL pgvector
- **ğŸ”’ Per-User Isolation**: Each user's documents are private

### ğŸ› ï¸ MCP (Model Context Protocol)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     MCP Integration                          â”‚
â”‚                                                              â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚   â”‚ ğŸŒ SSE      â”‚    â”‚ ğŸ“Ÿ STDIO    â”‚    â”‚ ğŸ”§ Custom   â”‚    â”‚
â”‚   â”‚  Server     â”‚    â”‚  Server     â”‚    â”‚  Tools      â”‚    â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚          â”‚                  â”‚                  â”‚            â”‚
â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                             â–¼                               â”‚
â”‚                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                       â”‚
â”‚                    â”‚  Tool Registry â”‚                       â”‚
â”‚                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                       â”‚
â”‚                             â”‚                               â”‚
â”‚                             â–¼                               â”‚
â”‚            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”               â”‚
â”‚            â”‚  ğŸ’¡ Skills = Tools + Prompts   â”‚               â”‚
â”‚            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜               â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸš€ Tanzu Platform Deployment

### Quick Start

```bash
# 1ï¸âƒ£ Build the application
mvn clean package -DskipTests

# 2ï¸âƒ£ Create services
cf create-service postgres on-demand-postgres-db cf-llama-chat-db
cf create-service genai multi-model tanzu-all-models

# 3ï¸âƒ£ Deploy!
cf push
```

### Service Bindings

| Service | Plan | Purpose |
|---------|------|---------|
| `genai` | `multi-model` | ğŸ¤– All AI models (chat + embedding) |
| `postgres` | `on-demand-postgres-db` | ğŸ—„ï¸ Data + pgvector embeddings |
| `p-identity` | `standard` | ğŸ” SSO/OAuth2 (optional) |

### manifest.yml

```yaml
applications:
  - name: cf-llama-chat
    memory: 1G
    instances: 1
    buildpacks:
      - java_buildpack_offline
    env:
      SPRING_PROFILES_ACTIVE: cloud
    services:
      - cf-llama-chat-db
      - tanzu-all-models
      # Individual model bindings (use if not using multi-model plan)
      # - tanzu-nomic-embed-text-v2-moe
      # - tanzu-gpt-oss-120b
      - cf-llama-chat-sso
```

---

## ğŸ“Š Metrics & Monitoring

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    ğŸ“ˆ Usage Metrics                          â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Chat Metrics                                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ“ Total Tokens: 1,234,567                     â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ â±ï¸  Avg Response Time: 2.3s                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸš€ Tokens/Second: 45.2                         â”‚    â”‚
â”‚  â”‚  â””â”€â”€ ğŸ’¬ Total Requests: 5,432                       â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  Embedding Metrics                                   â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ“„ Documents Processed: 234                    â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ§© Total Chunks: 12,456                        â”‚    â”‚
â”‚  â”‚  â”œâ”€â”€ ğŸ“Š Characters Embedded: 4.5M                   â”‚    â”‚
â”‚  â”‚  â””â”€â”€ âš¡ Avg Processing Time: 1.2s                   â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¨ Multi-Tenancy & Theming

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   ğŸ¢ Organizations                           â”‚
â”‚                                                              â”‚
â”‚   /acme-corp           /startup-xyz         /enterprise      â”‚
â”‚   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚   â”‚ ğŸ¨ Custom   â”‚     â”‚ ğŸ¨ Custom   â”‚     â”‚ ğŸ¨ Custom   â”‚   â”‚
â”‚   â”‚   Theme     â”‚     â”‚   Theme     â”‚     â”‚   Theme     â”‚   â”‚
â”‚   â”‚             â”‚     â”‚             â”‚     â”‚             â”‚   â”‚
â”‚   â”‚ ğŸ–¼ï¸ Logo     â”‚     â”‚ ğŸ–¼ï¸ Logo     â”‚     â”‚ ğŸ–¼ï¸ Logo     â”‚   â”‚
â”‚   â”‚ ğŸ­ Colors   â”‚     â”‚ ğŸ­ Colors   â”‚     â”‚ ğŸ­ Colors   â”‚   â”‚
â”‚   â”‚ âœï¸ Fonts    â”‚     â”‚ âœï¸ Fonts    â”‚     â”‚ âœï¸ Fonts    â”‚   â”‚
â”‚   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ğŸ·ï¸ Slug-Based Routing**: Access via `/{org-slug}` URLs
- **ğŸ¨ Full Theming**: Colors, fonts, border radius, custom CSS
- **ğŸ–¼ï¸ Custom Branding**: Logo, favicon, welcome message

---

## ğŸ” Authentication

```
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   Auth Options  â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                             â”‚
           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”‚                 â”‚                 â”‚
           â–¼                 â–¼                 â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ ğŸ”‘ Local     â”‚  â”‚ ğŸ¢ SSO/OAuth â”‚  â”‚ ğŸ« Invitationâ”‚
    â”‚   Username   â”‚  â”‚  via UAA     â”‚  â”‚    Codes     â”‚
    â”‚   Password   â”‚  â”‚  (optional)  â”‚  â”‚  (optional)  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

- **ğŸ‘¤ Local Auth**: Secure username/password with bcrypt hashing
- **ğŸ” Enterprise SSO**: OAuth2 via Cloud Foundry p-identity service
- **ğŸ‘‘ Role-Based Access**: Admin and User roles
- **ğŸ”‘ Password Management**: Admin reset & user change password

---

## ğŸ›¡ï¸ Admin Portal

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ğŸ‘‘ ADMIN PORTAL                                            â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ‘¥ Users  â”‚ â”‚ ğŸ¤– Models â”‚ â”‚ ğŸ› ï¸ Tools  â”‚ â”‚ ğŸ’¡ Skills â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ ğŸ”Œ MCP    â”‚ â”‚ ğŸ¢ Orgs   â”‚ â”‚ ğŸ“¦ Storageâ”‚ â”‚ ğŸ“Š Metricsâ”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”§ Tech Stack

| Layer | Technology |
|-------|------------|
| â˜• Backend | Spring Boot 3.4, Spring AI 1.1 |
| ğŸ¨ Frontend | Thymeleaf, Vanilla JS, CSS3 |
| ğŸ—„ï¸ Database | PostgreSQL + pgvector |
| ğŸ¤– AI | Tanzu GenAI, OpenAI, Ollama |
| ğŸ“„ Documents | Apache Tika, PDF Box |
| ğŸ“¦ Storage | S3-compatible (optional) |

---

## âš™ï¸ Configuration

### Environment Variables

| Variable | Description | Default |
|----------|-------------|---------|
| `SPRING_PROFILES_ACTIVE` | Active profile | `cloud` |
| `DOCUMENT_CHUNK_SIZE` | Chunk size for embeddings | `350` |
| `EMBEDDING_DIMENSIONS` | Vector dimensions | `512` |
| `RAG_TOP_K` | Top-K results for RAG | `5` |
| `APP_AUTH_SECRET` | Invitation code | - |

---

## ğŸ“š API Reference

<details>
<summary>ğŸ’¬ Chat APIs</summary>

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/chat/stream` | Streaming chat (SSE) |
| `POST` | `/api/chat` | Non-streaming chat |
| `GET` | `/api/chat/models` | List available models |
</details>

<details>
<summary>ğŸ“„ Document APIs</summary>

| Method | Endpoint | Description |
|--------|----------|-------------|
| `POST` | `/api/documents/upload` | Upload document |
| `GET` | `/api/documents` | List documents |
| `DELETE` | `/api/documents/{id}` | Delete document |
| `GET` | `/api/documents/search` | Semantic search |
</details>

<details>
<summary>ğŸ‘‘ Admin APIs</summary>

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/api/admin/users` | List users |
| `POST` | `/api/admin/mcp/servers` | Create MCP server |
| `GET` | `/api/admin/tools` | List tools |
| `POST` | `/api/admin/skills` | Create skill |
</details>

---

## ğŸ§ª Local Development

<details>
<summary>Click to expand local development instructions</summary>

### Prerequisites

- â˜• Java 21+
- ğŸ“¦ Maven 3.8+
- ğŸ”‘ OpenAI API Key or Ollama

### Setup

```bash
# Clone the repo
git clone https://github.com/nkuhn-vmw/cf-llama-chat.git
cd cf-llama-chat

# Set environment variables
export OPENAI_API_KEY=your-api-key

# Or for Ollama:
export CHAT_PROVIDER=ollama
export OLLAMA_BASE_URL=http://localhost:11434

# Run the application
mvn spring-boot:run

# Open http://localhost:8080
```

### Local Configuration

| Variable | Description | Default |
|----------|-------------|---------|
| `OPENAI_API_KEY` | OpenAI API key | - |
| `OPENAI_MODEL` | OpenAI model | `gpt-4o-mini` |
| `CHAT_PROVIDER` | AI provider | `openai` |
| `OLLAMA_BASE_URL` | Ollama URL | `http://localhost:11434` |
| `OLLAMA_MODEL` | Ollama model | `llama3.2` |

</details>

---

## ğŸ“ Project Structure

<details>
<summary>Click to expand project structure</summary>

```
src/main/java/com/example/cfchat/
â”œâ”€â”€ ğŸš€ CfLlamaChatApplication.java
â”œâ”€â”€ ğŸ” auth/
â”œâ”€â”€ âš™ï¸ config/
â”‚   â”œâ”€â”€ GenAiConfig.java          # Tanzu GenAI multi-model support
â”‚   â”œâ”€â”€ VectorStoreConfig.java    # Embedding & pgvector
â”‚   â””â”€â”€ SecurityConfig.java
â”œâ”€â”€ ğŸ® controller/
â”‚   â”œâ”€â”€ ChatController.java
â”‚   â”œâ”€â”€ DocumentController.java
â”‚   â”œâ”€â”€ AdminController.java
â”‚   â””â”€â”€ ...
â”œâ”€â”€ ğŸ“¦ model/
â”œâ”€â”€ ğŸ—„ï¸ repository/
â””â”€â”€ ğŸ”§ service/
    â”œâ”€â”€ ChatService.java
    â”œâ”€â”€ DocumentEmbeddingService.java
    â””â”€â”€ ...
```

</details>

---

## ğŸ“œ License

MIT License

---

<div align="center">

**Built with â¤ï¸ for Tanzu Platform**

```
  _____                        _    ___
 |_   _|_ _ _ __  _____ _     / \  |_ _|
   | |/ _` | '_ \|_  / | | | / _ \  | |
   | | (_| | | | |/ /| |_| |/ ___ \ | |
   |_|\__,_|_| |_/___|\__,_/_/   \_\___|
```

</div>
