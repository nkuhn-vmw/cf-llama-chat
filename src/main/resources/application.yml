spring:
  application:
    name: cf-llama-chat

  datasource:
    url: jdbc:h2:mem:chatdb;DB_CLOSE_DELAY=-1;DB_CLOSE_ON_EXIT=FALSE
    driver-class-name: org.h2.Driver
    username: sa
    password:

  jpa:
    hibernate:
      ddl-auto: update
    show-sql: false
    properties:
      hibernate:
        format_sql: true
    database-platform: org.hibernate.dialect.H2Dialect

  h2:
    console:
      enabled: true
      path: /h2-console

  ai:
    openai:
      api-key: ${OPENAI_API_KEY:}
      chat:
        options:
          model: ${OPENAI_MODEL:gpt-4o-mini}
          temperature: 0.7
      embedding:
        options:
          model: ${EMBEDDING_MODEL:text-embedding-3-small}
    ollama:
      base-url: ${OLLAMA_BASE_URL:http://localhost:11434}
      chat:
        options:
          model: ${OLLAMA_MODEL:llama3.2}
          temperature: 0.7

  thymeleaf:
    cache: false

  servlet:
    multipart:
      enabled: true
      max-file-size: 100MB
      max-request-size: 100MB

server:
  port: ${PORT:8080}

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics
  endpoint:
    health:
      show-details: always

app:
  chat:
    default-provider: ${CHAT_PROVIDER:openai}
    system-prompt: |
      You are a helpful, harmless, and honest AI assistant. You provide clear,
      accurate, and thoughtful responses. When you don't know something, you
      say so. You format your responses using Markdown when appropriate.
  auth:
    secret: ${APP_AUTH_SECRET:}
    require-invitation: ${APP_REQUIRE_INVITATION:false}
  # Document embedding configuration
  embedding:
    model: ${EMBEDDING_MODEL:text-embedding-3-small}
    dimensions: ${EMBEDDING_DIMENSIONS:512}
  documents:
    max-file-size: ${MAX_DOCUMENT_SIZE:104857600}
    max-documents-per-user: ${MAX_DOCUMENTS_PER_USER:50}
    chunk-size: ${DOCUMENT_CHUNK_SIZE:350}  # Keep under 512 tokens for nomic embedding model
    chunk-overlap: ${DOCUMENT_CHUNK_OVERLAP:100}
    rag-top-k: ${RAG_TOP_K:5}
