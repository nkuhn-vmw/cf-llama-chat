spring:
  autoconfigure:
    exclude:
      - org.springframework.ai.vectorstore.pgvector.autoconfigure.PgVectorStoreAutoConfiguration
      - org.springframework.ai.model.openai.autoconfigure.OpenAiEmbeddingAutoConfiguration
  datasource:
    url: ${vcap.services.chat-db.credentials.uri:jdbc:postgresql://localhost:5432/chatdb}
    driver-class-name: org.postgresql.Driver
    hikari:
      minimum-idle: 3
      maximum-pool-size: 8
      connection-timeout: 20000
      idle-timeout: 300000
      max-lifetime: 600000

  jpa:
    database-platform: org.hibernate.dialect.PostgreSQLDialect
    hibernate:
      ddl-auto: update

  h2:
    console:
      enabled: false

  # Disable auto-configuration of OpenAI/Ollama when using GenAI from VCAP
  ai:
    openai:
      enabled: false
    ollama:
      enabled: false
    vectorstore:
      pgvector:
        initialize-schema: true
        index-type: HNSW
        distance-type: COSINE_DISTANCE
        dimensions: ${EMBEDDING_DIMENSIONS:768}

  servlet:
    multipart:
      enabled: true
      max-file-size: 50MB
      max-request-size: 50MB

management:
  endpoints:
    web:
      exposure:
        include: health,info

app:
  chat:
    default-provider: genai
  # Document embedding configuration for cloud
  embedding:
    dimensions: ${EMBEDDING_DIMENSIONS:768}
  documents:
    max-file-size: ${MAX_DOCUMENT_SIZE:104857600}
    max-documents-per-user: ${MAX_DOCUMENTS_PER_USER:100}
    rag-top-k: ${RAG_TOP_K:10}

logging:
  level:
    io.pivotal.cfenv: INFO
    com.example.cfchat: INFO
